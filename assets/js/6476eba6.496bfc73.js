"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[722],{6192:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"usage","title":"Usage","description":"Each api rules can be used in a chainable or individual way.","source":"@site/docs/usage.md","sourceDirName":".","slug":"/usage","permalink":"/ngx-schematics-utilities/usage","draft":false,"unlisted":false,"editUrl":"https://github.com/dsi-hug/ngx-schematics-utilities/edit/main/docs/docs/usage.md","tags":[],"version":"current","frontMatter":{"title":"Usage"},"sidebar":"docs","previous":{"title":"Installation","permalink":"/ngx-schematics-utilities/"},"next":{"title":"Core","permalink":"/ngx-schematics-utilities/apis/core"}}');var o=i(1085),s=i(1184);const a={title:"Usage"},r=void 0,c={},l=[{value:"Chainable usage",id:"chainable-usage",level:3},{value:"<code>Workspace</code>",id:"workspace",level:4},{value:"<code>Application</code>",id:"application",level:4},{value:"<code>Library</code>",id:"library",level:4},{value:"Individual usage",id:"individual-usage",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Each api rules can be used in a ",(0,o.jsx)(n.a,{href:"#chainable-usage",children:(0,o.jsx)(n.strong,{children:"chainable"})})," or ",(0,o.jsx)(n.a,{href:"#individual-usage",children:(0,o.jsx)(n.strong,{children:"individual"})})," way."]}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsxs)(n.p,{children:["Currently, ",(0,o.jsx)(n.code,{children:"ng add"})," does not provide a way to choose which project you want a schematic to be used on.",(0,o.jsx)("br",{}),"\nTo provide such an option you will have to declare the following ",(0,o.jsx)(n.code,{children:"project"})," property, inside your ",(0,o.jsx)(n.code,{children:"schema.json"})," file:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"project": {\n  "type": "string",\n  "description": "The name of the project.",\n  "$default": {\n    "$source": "projectName"\n  }\n}\n'})}),(0,o.jsxs)(n.p,{children:["Users will then be able to provide a ",(0,o.jsx)(n.code,{children:"project"})," along your schematic installation:",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.em,{children:"(and if they do not, the default provider will populate the project option based on the inferred project from the cwd)"})]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"ng add YourSchematic --project ProjectName\n"})})]}),"\n",(0,o.jsx)(n.h3,{id:"chainable-usage",children:"Chainable usage"}),"\n",(0,o.jsx)(n.h4,{id:"workspace",children:(0,o.jsx)(n.code,{children:"Workspace"})}),"\n",(0,o.jsxs)(n.p,{children:["Allow you to act at the ",(0,o.jsx)(n.em,{children:"workspace"})," level."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:"{6-14}",children:"import { schematic, workspace } from '@hug/ngx-schematics-utilities';\nimport { Rule } from '@angular-devkit/schematics';\n\nexport default (options: any): Rule =>\n  schematic('my-schematic', [\n    workspace()\n      .spawn('ng', ['add', '@angular/material', '--skip-confirmation'])\n      .addPackageJsonDevDependencies(['eslint'])\n      .packageInstallTask()\n      .logInfo('Doing some cool stuff')\n      .isAngularVersion('<= 11', (): Rule => {\n        ...\n      })\n      .toRule(),\n  ], options);\n"})}),"\n",(0,o.jsx)(n.h4,{id:"application",children:(0,o.jsx)(n.code,{children:"Application"})}),"\n",(0,o.jsxs)(n.p,{children:["Allow you to act at a ",(0,o.jsx)(n.em,{children:"project"})," level and make sure the specified project is an ",(0,o.jsx)(n.em,{children:"application"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"__SRC__"})," will be interpolated with ",(0,o.jsx)(n.strong,{children:"sourceRoot"})," specified in the project's ",(0,o.jsx)(n.strong,{children:"angular.json"})," file.",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.code,{children:"__OUTPUT__"})," will be interpolated with ",(0,o.jsx)(n.strong,{children:"outputPath"})," specified in the project's ",(0,o.jsx)(n.strong,{children:"angular.json"})," file.",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.code,{children:"__ASSETS__"})," will be interpolated with ",(0,o.jsx)(n.strong,{children:"assetsPath"})," ",(0,o.jsx)(n.em,{children:"(if found, either /public or /src/assets)"}),".",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.code,{children:"__MAIN__"})," will be interpolated with ",(0,o.jsx)(n.strong,{children:"browser"})," or ",(0,o.jsx)(n.strong,{children:"main"})," specified in the project's ",(0,o.jsx)(n.strong,{children:"angular.json"})," file.",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.code,{children:"__CONFIG__"})," will be interpolated with the project's ",(0,o.jsx)(n.strong,{children:"config"})," file path ",(0,o.jsx)(n.em,{children:"(for standalone only)"}),"."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:"{6-14}",children:"import { application, ChainableApplicationContext, createOrUpdateFile, schematic } from '@hug/ngx-schematics-utilities';\nimport { Rule } from '@angular-devkit/schematics';\n\nexport default (options: any): Rule =>\n  schematic('my-schematic', [\n    application(options.project)\n      .deployFiles(options)\n      .addProviderToBootstrapApplication('__MAIN__', 'provideAnimations()', '@angular/platform-browser/animations'),\n      .addImportToFile('__SRC__/file.ts', 'environment', './environments/environment')\n      .deleteFiles(['karma.conf.js'])\n      .rule(({ project }: ChainableApplicationContext) => {\n        return createOrUpdateFile(project.pathFromRoot('README.md'), project.name);\n      })\n      .toRule()\n  ], options);\n"})}),"\n",(0,o.jsx)(n.h4,{id:"library",children:(0,o.jsx)(n.code,{children:"Library"})}),"\n",(0,o.jsxs)(n.p,{children:["Allow you to act at a ",(0,o.jsx)(n.em,{children:"project"})," level and make sure the specified project is a ",(0,o.jsx)(n.em,{children:"library"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"__SRC__"})," will be interpolated with the project ",(0,o.jsx)(n.strong,{children:"sourceRoot"})," specified in the ",(0,o.jsx)(n.strong,{children:"angular.json"})," file."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:"{6-8}",children:"import { library, schematic } from '@hug/ngx-schematics-utilities';\nimport { Rule } from '@angular-devkit/schematics';\n\nexport default (options: any): Rule =>\n  schematic('my-schematic', [\n    library(options.project)\n      .downloadFile('https://my-cdn.com/icons/icon.png', '__SRC__/assets/icons/icon.png')\n      .toRule()\n  ], options);\n"})}),"\n",(0,o.jsx)(n.h3,{id:"individual-usage",children:"Individual usage"}),"\n",(0,o.jsx)(n.admonition,{title:"Caution",type:"caution",children:(0,o.jsxs)(n.p,{children:["When used this way all the paths will be relative to the root of the workspace.",(0,o.jsx)("br",{}),"\nYou will have to make sure any modifications on a project are made in a generic way.",(0,o.jsx)("br",{}),"\nTo help you with that, the ",(0,o.jsx)(n.a,{href:"/apis/angular#getprojectfromworkspace",children:"getProjectFromWorkspace()"})," helper is a good start."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:"{6,8,10,12-16,18-19}",children:"import { addImportToFile, addPackageJsonDevDependencies, getProjectFromWorkspace, modifyJsonFile, packageInstallTask, schematic, rule, renameFile } from '@hug/ngx-schematics-utilities';\nimport { Rule, Tree, chain, noop } from '@angular-devkit/schematics';\n\nexport default async (options: any): Rule => {\n  async (tree: Tree): Promise<Rule> => {\n    const project = await getProjectFromWorkspace(tree, options.project);\n    return schematic('my-schematic', [\n      modifyJsonFile('tsconfig.json', ['compilerOptions', 'strict'], true),\n\n      addImportToFile(project.pathFromSourceRoot('main.ts'), 'environment', './environments/environment'),\n\n      rule((tree, context): Rule => {\n        ... return renameFile('old-file', 'new-file');\n        ... return chain([]);\n        ... return noop();\n      }),\n\n      addPackageJsonDevDependencies(['eslint']),\n      packageInstallTask()\n    ], options);\n  }\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1184:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var t=i(4041);const o={},s=t.createContext(o);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);